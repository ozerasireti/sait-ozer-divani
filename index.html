<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Ã–ZER DÄ°VANI</title>
<style>
body{margin:0;font-family:Segoe UI;background:#0a192f;color:#fff}
#login,#chat{height:100vh;display:flex;align-items:center;justify-content:center}
#chat{display:none;flex-direction:column;background:#f0f2f5;color:#000}
.box{background:#fff;padding:30px;border-radius:20px;width:320px;text-align:center}
.chat-area{flex:1;overflow:auto;width:100%;max-width:900px;padding:20px}
.msg{padding:12px 16px;border-radius:16px;margin-bottom:8px;max-width:80%}
.lider{background:#fff3cd;border:2px solid gold}
.bot{background:#fff;border-right:6px solid #1b5e20;margin-left:auto}
.input{display:flex;gap:10px;padding:10px;background:#fff;width:100%}
input{flex:1;padding:10px;border-radius:20px;border:1px solid #ccc}
button{padding:10px 20px;border-radius:20px;border:none;background:#b30000;color:#fff}
</style>
</head>
<body>

<div id="login">
  <div class="box">
    <h2>Ã–ZER DÄ°VANI</h2>
    <input id="isim" placeholder="Ä°sminiz">
    <button onclick="gir()">GÄ°R</button>
  </div>
</div>

<div id="chat">
  <h3 id="baslik"></h3>
  <div id="durum" style="display:none;color:green">Yapay zekÃ¢ konuÅŸuyorâ€¦</div>
  <div id="alan" class="chat-area"></div>
  <div class="input">
    <input id="mesaj" placeholder="Bir isme seslen...">
    <button onclick="gonder()">GÃ¶nder</button>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script>
const firebaseConfig = {
  apiKey: "FIREBASE_KEY",
  authDomain: "ozer-asireti-portal.firebaseapp.com",
  projectId: "ozer-asireti-portal"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const KANAL="ozer_divan";
const bots=[
"Kerem Ã–zer","HacÄ± Abdullah Ã–zer","Faruk Ã–zer","Ahmet Ã–zer",
"HacÄ± Remzi Ã–zer","Ali Ã–zer","Mahmut Enes DemiroÄŸlu","Mervan Cengiz"
];

let ad="",lider=false;

function gir(){
  ad=document.getElementById("isim").value.trim();
  if(ad.length<2) return alert("Ä°sim gir");
  lider=ad.toLowerCase().includes("sait");
  document.getElementById("login").style.display="none";
  document.getElementById("chat").style.display="flex";
  document.getElementById("baslik").innerHTML=ad+(lider?" ðŸ‘‘":"");
  dinle();
}

function dinle(){
  db.collection(KANAL).orderBy("t","asc").limit(50)
  .onSnapshot(s=>{
    alan.innerHTML="";
    s.forEach(d=>{
      let m=d.data();
      alan.innerHTML+=`<div class="msg ${m.isim.toLowerCase().includes("sait")?"lider":"bot"}">
      <b>${m.isim}</b><br>${m.mesaj}</div>`;
    });
    alan.scrollTop=alan.scrollHeight;
  });
}

async function gonder(){
  let m=mesaj.value.trim();
  if(!m) return;
  mesaj.value="";
  await db.collection(KANAL).add({isim:ad,mesaj:m,t:firebase.firestore.FieldValue.serverTimestamp()});
  let bot=bots.find(b=>m.toLowerCase().includes(b.split(" ")[0].toLowerCase()));
  if(bot && lider){
    durum.style.display="block";
    let r=await fetch("api.php",{method:"POST",headers:{"Content-Type":"application/json"},
      body:JSON.stringify({bot:bot,mesaj:m})});
    let j=await r.json();
    await db.collection(KANAL).add({isim:bot,mesaj:j.reply,t:firebase.firestore.FieldValue.serverTimestamp()});
    durum.style.display="none";
  }
}
</script>
</body>
</html>